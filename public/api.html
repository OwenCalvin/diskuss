<!DOCTYPE html>
<html lang=en>
    <head>
        <meta charset="utf-8">
        <title>Diskuss API v0.3-alpha</title>
        <style>
            * {
                box-sizing:border-box;
            }

            body {
                background:#aaf;
            }

            article {
                max-width: 60em;
                margin: 0 auto;
            }

            section {
                background:#fff;
                border-radius:10px;
                box-shadow:3px 3px 3px rgba(0, 0, 0, 0.5) inset;
                padding:20px;
                margin-bottom: 2em;
            }
            
            section h1 {
                font-size:24pt;
            }
            
            section h2 {
                font-size:18pt;
            }
            
            code {
                background:#333;
                border: 2px solid #000;
                color:#fff;
                display:inline-block;
                padding:10px;
            }

            table {
                background:#eee;
                margin-top:10px;
            }

            td, th {
                background:#fff;
                padding:5px;
            }
        </style>
    </head>
    <body>
        <article>
            <section>
                <h1>Diskuss API v0.3-alpha</h1>
                <p>This page shows the comprehensive list of request that are included in the Diskuss API.</p>
                <p>Diskuss is a chat server that can host numerous people in any number of channels. It handles group chat along with private chat.</p>
            </section>

            <section>
                <h2>Information</h2>
                <p>This request returns informations about the server itself to anyone, without authentication.</p>
                <h3>Request</h3>
                <code>GET /info/</code>
                <h3>Response</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Key</th>
                            <th>Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>version</td>
                            <td>The version of the server.</td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <section>
                <h2>List users</h2>
                <p>Anyone can ask for the list of connected users.</p>
                <h3>Request</h3>
                <code>GET /users/</code>
                <h3>Response</h3>
                <p>An array containing user objects.</p>
            </section>

            <section>
                <h2>Connection</h2>
                <p>In order to connect to the server, the client must request a GUID.</p>
                <h3>Request</h3>
                <code>POST /users/register/:nick</code>
                <table>
                    <thead>
                        <tr>
                            <th>Key</th>
                            <th>Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>nick</td>
                            <td>The nickname linked to the client. If the desired nickname was unavailable, "_1" will be append to it. If this is also unavailable, "_2" will be append instead and so on.</td>
                        </tr>
                    </tbody>
                </table>
                <h3>Response</h3>
                <p>A user object containing all the informations about the newly created user (including the GUID).</p>
            </section>
            
            <section>
                <h2>Disconnection</h2>
                <p>To disconnect from the server means having its GUID revoked.</p>
                <h3>Request</h3>
                <code>DELETE /user/:id/disconnect/</code>
                <table>
                    <thead>
                        <tr>
                            <th>Key</th>
                            <th>Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>id</td>
                            <td>The user GUID.</td>
                        </tr>
                    </tbody>
                </table>
                <h3>Response</h3>
                <p>The version of the server.</p>
            </section>

            <section>
                <h2>Whois</h2>
                <p>Anyone can ask the server informations about a connected user.</p>
                <h3>Request</h3>
                <code>GET /users/whois/:nick</code>
                <table>
                    <thead>
                        <tr>
                            <th>Key</th>
                            <th>Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>nick</td>
                            <td>The nickname of the user one wants to have informations about</td>
                        </tr>
                    </tbody>
                </table>
                <h3>Response</h3>
                <p>A user object representing whose nick matches the request.</p>
            </section>

            <section>
                <h2>List channels</h2>
                <p>Anyone can ask for the list of existing channels</p>
                <h3>Request</h3>
                <code>GET /channels/</code>
                <h3>Response</h3>
                <p>A list of channel objects.</p>
            </section>

            <section>
                <h2>Join channel</h2>
                <p>A user can join a channel with that request</p>
                <h3>Request</h3>
                <code>PUT /user/:id/channels/:channel/join/</code>
                <table>
                    <thead>
                        <tr>
                            <th>Key</th>
                            <th>Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>id</td>
                            <td>The user GUID.</td>
                        </tr>
                        <tr>
                            <td>channel</td>
                            <td>The name of the channel.</td>
                        </tr>
                    </tbody>
                </table>
                <h3>Response</h3>
                <p>The list of user objects representing the users that are currently in the channel.</p>
            </section>
            
            <section>
                <h2>Talk in channel</h2>
                <p>When a user is in a channel, he or she can say something that will be viewable by every other user in the same channel.</p>
                <h3>Request</h3>
                <code>PUT /user/:id/channels/:channel/say/?message=:message</code>
                <table>
                    <thead>
                        <tr>
                            <th>Key</th>
                            <th>Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>id</td>
                            <td>The user GUID.</td>
                        </tr>
                        <tr>
                            <td>channel</td>
                            <td>The name of the channel.</td>
                        </tr>
                        <tr>
                            <td>message</td>
                            <td>The message to transmit to other users.</td>
                        </tr>
                    </tbody>
                </table>
                <h3>Response</h3>
                <p>The user object that sent the message.</p>
            </section>

            <section>
                <h2>Leave channel</h2>
                <p>A user can leave a channel with that request</p>
                <h3>Request</h3>
                <code>DELETE /user/:id/channels/:channel/leave/</code>
                <table>
                    <thead>
                        <tr>
                            <th>Key</th>
                            <th>Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>id</td>
                            <td>The user GUID.</td>
                        </tr>
                        <tr>
                            <td>channel</td>
                            <td>The name of the channel.</td>
                        </tr>
                    </tbody>
                </table>
                <h3>Response</h3>
                <p>The user object.</p>
            </section>
            
            <section>
                <h2>Send private message</h2>
                <p>A user can send a private message that will only be viewable by the recipient.</p>
                <h3>Request</h3>
                <code>PUT /user/:id/message/:nick/?message=:message</code>
                <table>
                    <thead>
                        <tr>
                            <th>Key</th>
                            <th>Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>id</td>
                            <td>The sender GUID</td>
                        </tr>
                        <tr>
                            <td>nick</td>
                            <td>The recipient nick</td>
                        </tr>
                        <tr>
                            <td>message</td>
                            <td>The message to be sent</td>
                        </tr>
                    </tbody>
                </table>
                <h3>Response</h3>
                <p>The user object of the recipient</p>
            </section>
            
            <section>
                <h2>Fetch notices</h2>
                <p>Notices are stored in the user object, on the server. If a client wants to retrieve thoses notices, it must send a request to ask for them.</p>
                <h3>Request</h3>
                <code>GET /user/:id/notices</code>
                <table>
                    <thead>
                        <tr>
                            <th>Key</th>
                            <th>Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>id</td>
                            <td>The user GUID.</td>
                        </tr>
                    </tbody>
                </table>
                <h3>Response</h3>
                <p>A JSON list that contains all the notices addressed to the user.</p>
                <p>Possible notices have different structure with a common attribute <code>type</code>. Here are the structures of the notices:</p>
                <table>
                    <thead>
                        <tr>
                            <th>Type</th>
                            <th colspan="3">Other attributes</th>
                            <th>Example</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <th rowspan="2">channelJoin</th>
                            <th>nick</th>
                            <th>channel</th>
                            <th rowspan="2"></th>
                            <td rowspan="2"><code>{ type: 'channelJoin', nick: 'user_1', channel: 'help' }</code></td>
                        </tr>
                        <tr>
                            <td>The nick of the user that joins the channel.</td>
                            <td>The channel concerned.</td>
                        </tr>
                        <tr>
                            <th rowspan="2">channelMessage</th>
                            <th>nick</th>
                            <th>channel</th>
                            <th>message</th>
                            <td rowspan="2"><code>{ type: 'channelMessage', nick: 'user_1', channel: 'help', message:'Hello, world!' }</code></td>
                        </tr>
                        <tr>
                            <td>The nick of the speaker.</td>
                            <td>The channel concerned.</td>
                            <td>The message to display.</td>
                        </tr>
                        <tr>
                            <th rowspan="2">channelLeave</th>
                            <th>nick</th>
                            <th>channel</th>
                            <th rowspan="2"></th>
                            <td rowspan="2"><code>{ type: 'channelLeave', nick: 'user_1', channel: 'help' }</code></td>
                        </tr>
                        <tr>
                            <td>The nick of the leaving user.</td>
                            <td>The channel concerned.</td>
                        </tr>
                        <tr>
                            <th rowspan="2">privateMessage</th>
                            <th>sender</th>
                            <th>recipient</th>
                            <th>message</th>
                            <td rowspan="2"><code>{ type: 'privateMessage', sender: 'user_1', recipient: 'user_2', message: 'Hello, world!' }</code></td>
                        </tr>
                        <tr>
                            <td>The nick of the sender.</td>
                            <td>The nick of the recipient</td>
                            <td>The message to display.</td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <section>
                <h2>User object</h2>
                <p>A user object is composed of:</p>
                <table>
                    <thead>
                        <tr>
                            <th>Key</th>
                            <th>Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>id</td>
                            <td>A GUID (this is never shown, except when a new user registers).</td>
                        </tr>
                        <tr>
                            <td>nick</td>
                            <td>The nickname of the user.</td>
                        </tr>
                        <tr>
                            <td>channels</td>
                            <td>The list of channels the user is currently in.</td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <section>
                <h2>Channel object</h2>
                <p>A channel object is composed of:</p>
                <table>
                    <thead>
                        <tr>
                            <th>Key</th>
                            <th>Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>name</td>
                            <td>The name of the channel is also its identifier.</td>
                        </tr>
                        <tr>
                            <td>description</td>
                            <td>A description of the channel.</td>
                        </tr>
                        <tr>
                            <td>keep</td>
                            <td>If true, the channel will exist even if it contains no user.</td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <section>
                <h2>Error handling</h2>
                <p>Whatever the URI may be, if the resource or action asked is unavailable for some reason or the action is illegal, a JSON containing a single entry which key is called <code>error</code> will be sent. The value of that entry is the error message.</p>
            </section>
        </article>
    </body>
</html>
